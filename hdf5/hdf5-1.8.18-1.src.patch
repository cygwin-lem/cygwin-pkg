--- origsrc/hdf5-1.8.18/test/Makefile.am	2016-11-04 19:41:07.000000000 +0100
+++ src/hdf5-1.8.18/test/Makefile.am	2017-04-08 14:21:28.181585500 +0200
@@ -77,18 +77,18 @@ endif
 
 if HAVE_SHARED_CONDITIONAL
   # The libh5test library provides common support code for the tests.
-  noinst_LTLIBRARIES=libh5test.la
 
   # The libdynlib1, libdynlib2, libdynlib3, and libdynlib4 library for testing plugin module plugin.c.
   # Build it as shared library if configure is enabled for shared library.
-  lib_LTLIBRARIES=libdynlib1.la libdynlib2.la libdynlib3.la libdynlib4.la
+  noinst_LTLIBRARIES=libh5test.la libdynlib1.la libdynlib2.la libdynlib3.la libdynlib4.la
   libdynlib1_la_SOURCES=dynlib1.c
   libdynlib2_la_SOURCES=dynlib2.c
   libdynlib3_la_SOURCES=dynlib3.c
   libdynlib4_la_SOURCES=dynlib4.c
-
-install-exec-hook:
-	$(RM) $(DESTDIR)$(libdir)/*dynlib*
+  libdynlib1_la_LIBADD=$(LIBHDF5)
+  libdynlib2_la_LIBADD=$(LIBHDF5)
+  libdynlib3_la_LIBADD=$(LIBHDF5)
+  libdynlib4_la_LIBADD=$(LIBHDF5)
 
 else
   # The libh5test library provides common support code for the tests.
@@ -96,6 +96,7 @@ else
 endif
 
 libh5test_la_SOURCES=h5test.c testframe.c cache_common.c
+libh5test_la_LIBADD=$(LIBHDF5)
 
 # Use libhd5test.la to compile all of the tests
 LDADD=libh5test.la $(LIBHDF5)
--- origsrc/hdf5-1.8.18/tools/h5repack/Makefile.am	2016-11-04 19:41:07.000000000 +0100
+++ src/hdf5-1.8.18/tools/h5repack/Makefile.am	2017-04-08 14:21:28.219587700 +0200
@@ -63,12 +63,12 @@ h5repack.sh.chkexe_: h5repacktst.chkexe_
 
 if HAVE_SHARED_CONDITIONAL
   # Build it as shared library if configure is enabled for shared library.
-  lib_LTLIBRARIES=libdynlibadd.la libdynlibvers.la
+  noinst_LTLIBRARIES=libdynlibadd.la libdynlibvers.la
   libdynlibadd_la_SOURCES=dynlib_rpk.c
   libdynlibvers_la_SOURCES=dynlib_vrpk.c
+  libdynlibadd_la_LIBADD=$(LIBHDF5)
+  libdynlibvers_la_LIBADD=$(LIBHDF5)
 
-install-exec-hook:
-	$(RM) $(DESTDIR)$(libdir)/*dynlib*
 endif
 
 # Temporary files.  *.h5 are generated by h5repack.  They should
